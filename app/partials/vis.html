<svg id="vis" ng-controller="VisCtrl" ng-show="model.showVis">
  <g id="countries">
    <g ng-repeat="d in countryGeometries">
      <title>{{ d.alpha2 }}</title>
      <path d="{{ countryPaths[d.alpha2] }}" fill="rgba(255, 255, 255, {{ opacityByCountry[d.alpha2] || 0 }})" class="{{ d.alpha2 }}"/>
    </g>
  </g>
  <g id="peersCurrent">
    <g ng-repeat="peer in model.connectivity.peers.current">
      <path d="M {{ self.x }} {{ self.y }} Q {{ controlpoint(peer).x }} {{ controlpoint(peer).y }} {{ project(peer).x }} {{ project(peer).y }}" class="p2p"/>
      <circle cx="{{ project(peer).x }}" cy="{{ project(peer).y }}" r="{{ peerR }}"
              id="{{ peer.peerid }}" class="peer {{ peer.mode }}" filter="url(#blur)">
        <title>{{ peer | prettyUser }}</title>
      </circle>
      <animate attributeType="CSS" attributeName="opacity" from="0" to="1" dur="3s" repeatCount="1"/>
    </g>
  </g>
  <!-- XXX show last seen locations of peers not connected to -->
  <circle id="self" cx="{{ self.x }}" cy="{{ self.y }}" r="{{ selfR }}"
          class="{{ model.settings.mode }}" filter="url(#blur)">
    <title>{{ model.profile | prettyUser }}</title>
    <!--animate attributeType="CSS" attributeName="opacity" from=".5" to="1" dur="2s" repeatCount="indefinite"/-->
  </circle>
  <defs>
    <filter id="blur">
      <feGaussianBlur stdDeviation="1" />
    </filter>
  </defs>
</svg>
